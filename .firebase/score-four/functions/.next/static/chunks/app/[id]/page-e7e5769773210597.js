(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[531],{8335:function(e,n,t){Promise.resolve().then(t.bind(t,6616))},1254:function(e,n,t){"use strict";t.d(n,{A:function(){return u},I:function(){return c},db:function(){return o}});var r=t(994),i=t(4086),s=t(3085);let l=(0,r.ZF)({apiKey:"AIzaSyD9eYEtwrIUPDp4b_4x_e1zset6SmIpt_I",authDomain:"score-four.firebaseapp.com",projectId:"score-four",storageBucket:"485195295425",messagingSenderId:"1:485195295425:web:07b44dbcecb811a6014240",appId:"G-RNN3F03DQJ"}),o=(0,i.ad)(l),c=(0,s.v0)(l),u=new s.hJ},4811:function(e,n,t){"use strict";t.d(n,{BQ:function(){return l},am:function(){return o}});var r=t(1254),i=t(4086),s=t(9884);function l(e){let n=(0,i.IO)((0,i.hJ)(r.db,"games"),(0,i.ar)("status","==",s.Rl));(0,i.cf)(n,n=>{let t=[];n.forEach(e=>{t.push({id:e.id,...e.data()})}),e(t)})}function o(e,n){(0,i.cf)((0,i.JU)(r.db,"games",e),e=>{n({id:e.id,...e.data()})})}},8707:function(e,n,t){"use strict";t.d(n,{Ss:function(){return c},dz:function(){return u},nY:function(){return o}});var r=t(1254),i=t(4086),s=t(5548),l=t(9884);async function o(e){await (0,i.pl)((0,i.JU)(r.db,"games",e),{whitePlayer:{uid:r.I.currentUser.uid,displayName:r.I.currentUser.displayName},status:l.Bj},{merge:!0})}async function c(e,n,t){let s=arguments.length>3&&void 0!==arguments[3]?arguments[3]:"",o=arguments.length>4&&void 0!==arguments[4]?arguments[4]:[];console.log(s,o),(0,i.r7)((0,i.JU)(r.db,"games",e),{moves:(0,i.vr)({lastMove:n,position:JSON.stringify(t)}),...s?{winner:s,winningPegs:o,status:l.Qc}:{}})}async function u(){let e=(0,s.W)(),n=await (0,i.pl)((0,i.JU)(r.db,"games",e),{moves:[{move:null,position:JSON.stringify(Array(64).fill(0))}],status:l.Rl,blackPlayer:{uid:r.I.currentUser.uid,displayName:r.I.currentUser.displayName},whitePlayer:null,winner:null,winningPegs:[]});return console.log(n),e}t(4811)},6616:function(e,n,t){"use strict";t.r(n),t.d(n,{default:function(){return g}});var r=t(7437);t(6691);var i=t(2265),s=t(8707),l=t(5548),o=t(9884),c=t(4811);function u(e){if(16!==e.length){let n=[];for(let t=0;t<16;t++)n.push(e.slice(4*t,4*t+4));e=n}let n="";return(n=function(e){let n=[];for(let t=0;t<4;t++)for(let r=0;r<4;r++)for(let i=0;i<4;i++){let s=4*r+i,l=e[s][t],o=a(l,n,i);if(o)return{winner:o,winningPegs:[s,s-1,s-2,s-3]};!1===o&&(n=[])}}(e))||(n=function(e){let n=[];for(let t=0;t<4;t++)for(let r=0;r<4;r++)for(let i=0;i<4;i++){let s=4*i+r,l=e[s][t],o=a(l,n,i);if(o)return{winner:o,winningPegs:[s,s-4,s-8,s-12]};!1===o&&(n=[])}}(e))||(n=function(e){let n=[];for(let t=0;t<4;t++){for(let r=0;r<4;r++){let i=5*r,s=e[i][t],l=a(s,n,r);if(l)return{winner:l,winningPegs:[0,5,10,15]};!1===l&&(n=[])}for(let r=0;r<4;r++){let i=3*r+3,s=e[i][t],l=a(s,n,r);if(l)return{winner:l,winningPegs:[3,6,9,12]};!1===l&&(n=[])}}}(e))||(n=function(e){let n=[];for(let t=0;t<4;t++)for(let r=0;r<4;r++)for(let i=0;i<4;i++){let s=4*t+r,l=e[s][i],o=a(l,n,i);if(o)return{winner:o,winningPegs:[s]};!1===o&&(n=[])}}(e))||(n=function(e){let n=[];for(let t=0;t<4;t++){for(let r=0;r<4;r++){let i=4*t+r,s=e[i][r],l=a(s,n,r);if(l)return{winner:l,winningPegs:[i,i-1,i-2,i-3]};!1===l&&(n=[])}for(let r=0;r<4;r++){let i=4*t+r,s=e[i][3-r],l=a(s,n,r);if(l)return{winner:l,winningPegs:[i,i-1,i-2,i-3]};!1===l&&(n=[])}}}(e))||(n=function(e){let n=[];for(let t=0;t<4;t++){for(let r=0;r<4;r++){let i=4*r+t,s=e[i][r],l=a(s,n,r);if(l)return{winner:l,winningPegs:[i,i-4,i-8,i-12]};!1===l&&(n=[])}for(let r=0;r<4;r++){let i=4*r+t,s=e[i][3-r],l=a(s,n,r);if(l)return{winner:l,winningPegs:[i,i-4,i-8,i-12]};!1===l&&(n=[])}}}(e))||(n=function(e){let n=[];for(let t=0;t<2;t++)for(let r=0;r<4;r++){let i=5*r,s=0===t?e[i][3-r]:e[i][r],l=a(s,n,r);if(l)return{winner:l,winningPegs:[0,5,10,15]};!1===l&&(n=[])}for(let t=0;t<2;t++)for(let r=0;r<4;r++){let i=3*r+3,s=0===t?e[i][3-r]:e[i][r],l=a(s,n,r);if(l)return{winner:l,winningPegs:[3,6,9,12]};!1===l&&(n=[])}}(e))?n:!function(e){for(let n=0;n<16;n++)if(e[n].findIndex(e=>0===e)>-1)return!1;return!0}(e)?n:{winner:"draw",winningPegs:[],board:e}}function a(e,n,t){if(0===e)return!1;if(0===t)n.push(e);else{if(e!==n[t-1])return!1;if(3===t)return 1==e?"W":"B";n.push(e)}}function f(e){let{beads:n,onPegClick:t,className:i}=e;return(0,r.jsx)("div",{className:"bg-gray-400 rounded w-8 h-28 flex flex-col-reverse items-center justify-start overflow-hidden ".concat(i),onClick:t,children:n.filter(e=>0!==e).map((e,n)=>(0,r.jsx)("div",{className:"w-full h-6 border-t border-gray-400 ".concat(1===e?"bg-white":"bg-black")},"bead-".concat(n)))})}function d(e){let{board:n,onPegClick:t,winningPegs:i,myTurn:s,status:l}=e,c=[];for(let e=0;e<16;e++)c.push(n.slice(4*e,4*e+4));return(0,r.jsx)("div",{className:"grid grid-cols-4 grid-rows-4 gap-10",children:c.map((e,n)=>(0,r.jsx)(f,{beads:e,onPegClick:()=>t(n),className:"".concat(i.length>0&&!i.includes(n)&&"opacity-30"," ").concat(s&&!e.find(e=>0===e)&&l===o.Bj&&"cursor-pointer")},"peg-".concat(n)))})}function g(e){let{game:n,id:t}=e,[a,f]=(0,i.useState)(JSON.parse(n.moves.slice(-1)[0].position)),[g,h]=(0,i.useState)(n.moves),[m,w]=(0,i.useState)(n.status),[p,v]=(0,i.useState)(n.winner),[b,x]=(0,i.useState)(n.winningPegs),y=(0,i.useRef)(!1),P=localStorage.getItem("user")===n.blackPlayer.uid,[N,j]=(0,i.useState)(P?n.moves.length%2==1:n.moves.length%2==0),k=g.findIndex(e=>e.position===JSON.stringify(a)),I=k===g.length-1,S=(0,i.useRef)(null);(0,i.useEffect)(()=>{if(S.current){let e=S.current.scrollHeight*(parseInt((k-1)/2)/(g.length/2))-S.current.getBoundingClientRect().height/2+30;S.current.scrollTop=e}},[S,k,g]);let E=u(a);!p&&E&&(x(E.winningPegs),v(E.winner));let J=(0,i.useCallback)(e=>{f(JSON.parse(e.position)),v(""),x([])},[S,k,g]),O=(0,i.useCallback)(e=>{switch(e.key){case"ArrowLeft":k>1&&J(g[k-1]);break;case"ArrowRight":k<g.length-1&&J(g[k+1]);break;case"ArrowUp":k>1&&J(g[1]);break;case"ArrowDown":k<g.length-1&&J(g[g.length-1])}},[k,g,J]);return(0,i.useEffect)(()=>{y.current||((0,c.am)(t,e=>{let n=JSON.parse(e.moves.slice(-1)[0].position);f(n),h(e.moves),w(e.status),j(P?e.moves.length%2==1:e.moves.length%2==0)}),y.current=!0)},[y]),(0,i.useEffect)(()=>(document.addEventListener("keydown",O),()=>{document.removeEventListener("keydown",O)}),[O]),(0,r.jsxs)("main",{className:"flex min-h-screen items-center text-white justify-center p-16",children:[(0,r.jsx)("div",{className:"bg-slate-500 p-20 rounded-md relative ".concat("W"===p?"text-white":"B"===p?"text-black":""),children:(0,r.jsx)("div",{children:(0,r.jsx)(d,{board:a,onPegClick:e=>{let n=[...a],r=n.slice(4*e,4*e+4),i=r.findIndex(e=>0===e);if(!N||-1===i||m!==o.Bj||!I)return;j(!1),n[4*e+i]=P?-1:1,f(n);let c=u(n);c&&(x(c.winningPegs),v(c.winner)),(0,s.Ss)(t,(0,l.c)(e),n,null==c?void 0:c.winner,null==c?void 0:c.winningPegs)},winningPegs:b,myTurn:N,status:m})})}),(0,r.jsxs)("div",{className:"bg-slate-800 w-64 h-48 ml-8 flex flex-col rounded overflow-hidden",children:[(0,r.jsx)("div",{className:"text-xl w-full text-center h-8 flex align-items-center justify-center ".concat((N&&!P||!N&&P)&&"text-white"),children:p?"W"===p?"White Wins":"B"===p?"Black Wins":"Draw":m!==o.Qc?m===o.Rl?"Waiting for Opponent":N?"Your Turn":"Opponent's Turn":"Game Completed"}),(0,r.jsx)("div",{ref:S,className:"grid grid-cols-[30px_1fr_1fr] grow-1 bg-slate-800 m-h-0 overflow-y-auto overflow-x-hidden no-scrollbar",children:g.slice(1).map((e,n)=>(0,r.jsxs)(i.Fragment,{children:[n%2==0&&(0,r.jsx)("div",{className:"text-center bg-slate-500",children:n/2+1}),(0,r.jsx)("div",{className:"cursor-pointer pl-4 ".concat(k===n+1?"bg-slate-600":"hover:bg-slate-700"),onClick:()=>J(e),children:e.lastMove})]},"move-".concat(n)))})]})]})}t(1254)},9884:function(e,n,t){"use strict";t.d(n,{Bj:function(){return i},Qc:function(){return s},Rl:function(){return r}});let r="AVAILABLE",i="IN_PROGRESS",s="COMPLETED"},5548:function(e,n,t){"use strict";t.d(n,{W:function(){return r},c:function(){return i}});let r=()=>{let e="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz";return Array.from({length:15},()=>e.charAt(Math.floor(Math.random()*e.length))).join("")},i=e=>{let n=["a","b","c","d"][e%4];return"".concat(n).concat(4-Math.floor(e/4))}}},function(e){e.O(0,[358,214,647,691,971,864,744],function(){return e(e.s=8335)}),_N_E=e.O()}]);